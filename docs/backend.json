{
  "entities": {
    "Estate": {
      "title": "Estate",
      "type": "object",
      "description": "Represents the overall estate, owned by a user.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the estate, matches owner's UID." },
        "name": { "type": "string", "description": "Name of the estate." },
        "ownerId": { "type": "string", "description": "UID of the user who owns this estate data." },
        "createdAt": { "type": "string", "description": "ISO timestamp of when the estate was created."}
      },
      "required": ["id", "name", "ownerId", "createdAt"]
    },
    "Personnel": {
      "title": "Personnel",
      "type": "object",
      "description": "Represents an employee or staff member.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "familyName": { "type": "string" },
        "nationalId": { "type": "string" },
        "accountNumber": { "type": "string" },
        "insuranceNumber": { "type": "string" },
        "hireDate": { "type": "string", "format": "date" },
        "phone": { "type": "string" },
        "position": { "type": "string", "enum": ["سرایدار", "خدمات", "نگهبان", "حسابدار", "مدیر شهرک"] },
        "status": { "type": "string", "enum": ["مشغول کار", "اتمام کار", "مرخصی", "غیبت"] },
        "photoUrl": { "type": "string", "format": "uri", "description": "URL of the personnel's profile photo." },
        "childrenCount": { "type": "number", "description": "Number of children for payroll calculations." },
        "estateId": { "type": "string", "description": "FK to Estate" }
      },
      "required": ["id", "name", "familyName", "position", "status", "estateId"]
    },
    "Resident": {
      "title": "Resident",
      "type": "object",
      "description": "Represents a resident living in a villa.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "familyName": { "type": "string" },
        "phone": { "type": "string" },
        "carPlates": { "type": "string" },
        "villaNumber": { "type": "number" },
        "status": { "type": "string", "enum": ["ساکن", "خالی"] },
        "isPresent": { "type": "boolean" },
        "estateId": { "type": "string", "description": "FK to Estate" },
        "villaId": { "type": "string", "description": "FK to Villa"}
      },
      "required": ["id", "name", "familyName", "villaNumber", "status", "isPresent", "estateId", "villaId"]
    },
    "BoardMember": {
      "title": "BoardMember",
      "type": "object",
      "description": "Represents a member of the board.",
      "properties": {
        "id": { "type": "string" },
        "residentId": { "type": "string" },
        "name": { "type": "string" },
        "familyName": { "type": "string" },
        "position": { "type": "string" },
        "phone": { "type": "string" },
        "villaNumber": { "type": "number" },
        "estateId": { "type": "string", "description": "FK to Estate" }
      },
      "required": ["id", "residentId", "name", "familyName", "position", "estateId"]
    },
    "Villa": {
      "title": "Villa",
      "type": "object",
      "description": "Represents a villa or property.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "owner": { "type": "string" },
        "area": { "type": "number" },
        "residentInfo": { "type": "string" },
        "phone": { "type": "string" },
        "villaNumber": { "type": "number" },
        "occupantType": { "type": "string", "enum": ["owner", "tenant"], "description": "Indicates if the current occupant is the owner or a tenant." },
        "estateId": { "type": "string", "description": "FK to Estate" }
      },
      "required": ["id", "name", "owner", "villaNumber", "estateId", "occupantType"]
    },
    "FinancialTransaction": {
      "title": "FinancialTransaction",
      "type": "object",
      "description": "Represents a financial transaction.",
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["دریافتی", "پرداختی"] },
        "party": { "type": "string" },
        "reason": { "type": "string" },
        "amount": { "type": "number" },
        "date": { "type": "string", "format": "date" },
        "estateId": { "type": "string", "description": "FK to Estate" }
      },
      "required": ["id", "type", "party", "amount", "date", "estateId"]
    },
    "Document": {
      "title": "Document",
      "type": "object",
      "description": "Represents a document.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "category": { "type": "string", "enum": ["شهرک", "پرسنل", "ساکنین", "ویلا"] },
        "uploadDate": { "type": "string", "format": "date" },
        "url": { "type": "string", "format": "uri" },
        "fileName": { "type": "string" },
        "relatedEntityId": { "type": "string", "description": "FK to another entity like Personnel or Resident" },
        "description": { "type": "string" },
        "estateId": { "type": "string", "description": "FK to Estate" }
      },
      "required": ["id", "name", "category", "uploadDate", "url", "fileName", "estateId"]
    },
     "CompanyInfo": {
      "title": "CompanyInfo",
      "type": "object",
      "description": "Stores basic company/estate information.",
      "properties": {
        "name": { "type": "string" },
        "defaultEntryTime": { "type": "string" },
        "defaultExitTime": { "type": "string" },
        "estateId": { "type": "string" }
      },
      "required": ["name", "estateId"]
    },
    "PayrollSettings": {
      "title": "PayrollSettings",
      "type": "object",
      "description": "Stores payroll calculation settings based on labor laws.",
      "properties": {
        "baseSalaryOfMonth": { "type": "number", "description": "Base salary for a full month of work." },
        "overtimeMultiplier": { "type": "number", "description": "Multiplier for overtime hours (e.g., 1.4)." },
        "nightWorkMultiplier": { "type": "number", "description": "Multiplier for night work hours (e.g., 1.35)." },
        "holidayWorkMultiplier": { "type": "number", "description": "Multiplier for holiday work hours (e.g., 1.9)." },
        "childAllowance": { "type": "number", "description": "Fixed amount for child allowance per child." },
        "housingAllowance": { "type": "number", "description": "Fixed amount for housing allowance." },
        "foodAllowance": { "type": "number", "description": "Fixed amount for food allowance." },
        "insuranceDeductionPercentage": { "type": "number", "description": "Employee's insurance deduction percentage (e.g., 7)." },
        "maxAllowedLateness": { "type": "number", "description": "Maximum allowed lateness in minutes before penalty." },
        "latenessPenaltyAmount": { "type": "number", "description": "Deduction amount for being late." },
        "estateId": { "type": "string" }
      },
      "required": ["baseSalaryOfMonth", "overtimeMultiplier", "childAllowance", "housingAllowance", "foodAllowance", "insuranceDeductionPercentage", "estateId"]
    },
     "WorkLog": {
      "title": "WorkLog",
      "type": "object",
      "description": "Represents a monthly work log for personnel.",
      "properties": {
        "id": { "type": "string", "description": "Composite ID: {personnelId}-{year}-{month}" },
        "personnelId": { "type": "string" },
        "year": { "type": "number" },
        "month": { "type": "number" },
        "days": { 
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "day": {"type": "number"},
                    "entryTime": {"type": "string"},
                    "exitTime": {"type": "string"},
                    "hoursWorked": {"type": "number"},
                    "overtimeHours": {"type": "number"},
                    "holidayHours": {"type": "number"},
                    "nightWorkHours": {"type": "number"}
                },
                 "required": ["day"]
            }
        },
        "estateId": { "type": "string" }
      },
      "required": ["id", "personnelId", "year", "month", "days", "estateId"]
    },
     "PayrollRecord": {
      "title": "PayrollRecord",
      "type": "object",
      "description": "Stores a calculated payroll record.",
      "properties": {
        "id": { "type": "string" },
        "personnelId": { "type": "string" },
        "personnelName": { "type": "string" },
        "calculationDate": { "type": "string", "format": "date" },
        "estateId": { "type": "string" },
        "workLogId": { "type": "string" },
        "totalHoursWorked": { "type": "number" },
        "totalOvertimeHours": { "type": "number" },
        "totalHolidayHours": { "type": "number" },
        "totalNightWorkHours": { "type": "number" },
        "housingAllowance": { "type": "number" },
        "foodAllowance": { "type": "number" },
        "childAllowance": { "type": "number" },
        "baseSalaryPay": { "type": "number" },
        "overtimePay": { "type": "number" },
        "holidayPay": { "type": "number" },
        "nightWorkPay": { "type": "number" },
        "taxDeduction": { "type": "number" },
        "insuranceDeduction": { "type": "number" },
        "latenessDeduction": { "type": "number" },
        "otherDeductions": { "type": "number" },
        "grossPay": { "type": "number" },
        "netPay": { "type": "number" }
      },
      "required": ["id", "personnelId", "calculationDate", "grossPay", "netPay", "estateId"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
     "collections": [
      {
        "path": "/estates/{estateId}",
        "schema": { "$ref": "#/entities/Estate" },
        "description": "Top-level collection for estates. The document ID is the UID of the owner."
      },
      {
        "path": "/estates/{estateId}/personnel/{personnelId}",
        "schema": { "$ref": "#/entities/Personnel" },
        "description": "Subcollection for personnel belonging to an estate."
      },
      {
        "path": "/estates/{estateId}/residents/{residentId}",
        "schema": { "$ref": "#/entities/Resident" },
        "description": "Subcollection for residents belonging to an estate."
      },
      {
        "path": "/estates/{estateId}/boardMembers/{boardMemberId}",
        "schema": { "$ref": "#/entities/BoardMember" },
        "description": "Subcollection for board members of an estate."
      },
      {
        "path": "/estates/{estateId}/villas/{villaId}",
        "schema": { "$ref": "#/entities/Villa" },
        "description": "Subcollection for villas within an estate."
      },
      {
        "path": "/estates/{estateId}/financialTransactions/{transactionId}",
        "schema": { "$ref": "#/entities/FinancialTransaction" },
        "description": "Subcollection for financial transactions of an estate."
      },
      {
        "path": "/estates/{estateId}/documents/{documentId}",
        "schema": { "$ref": "#/entities/Document" },
        "description": "Subcollection for documents related to an estate."
      },
      {
        "path": "/estates/{estateId}/companyInfo/{docId}",
        "schema": { "$ref": "#/entities/CompanyInfo" },
        "description": "Subcollection for storing company info."
      },
      {
        "path": "/estates/{estateId}/payrollSettings/{docId}",
        "schema": { "$ref": "#/entities/PayrollSettings" },
        "description": "Subcollection for storing payroll settings."
      },
      {
        "path": "/estates/{estateId}/workLogs/{docId}",
        "schema": { "$ref": "#/entities/WorkLog" },
        "description": "Subcollection for storing daily work logs."
      },
      {
        "path": "/estates/{estateId}/payrollRecords/{docId}",
        "schema": { "$ref": "#/entities/PayrollRecord" },
        "description": "Subcollection for storing calculated payroll records."
      }
    ]
  }
}
